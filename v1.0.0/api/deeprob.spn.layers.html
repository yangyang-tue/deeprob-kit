<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>deeprob.spn.layers package &mdash; DeeProb-kit 0.6.4 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="deeprob.spn.learning package" href="deeprob.spn.learning.html" />
    <link rel="prev" title="deeprob.spn.algorithms package" href="deeprob.spn.algorithms.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> DeeProb-kit
            <img src="../_static/deeprob-logo-minimal.svg" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Read Me</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../home.html">Abstract</a></li>
<li class="toctree-l1"><a class="reference internal" href="../home.html#features">Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../home.html#installation-documentation">Installation &amp; Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../home.html#datasets-and-experiments">Datasets and Experiments</a></li>
<li class="toctree-l1"><a class="reference internal" href="../home.html#code-examples">Code Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../home.html#related-repositories">Related Repositories</a></li>
<li class="toctree-l1"><a class="reference internal" href="../home.html#references">References</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Modules</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="deeprob.html">deeprob package</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="deeprob.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="deeprob.flows.html">deeprob.flows package</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="deeprob.spn.html">deeprob.spn package</a><ul class="current">
<li class="toctree-l4 current"><a class="reference internal" href="deeprob.spn.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l5"><a class="reference internal" href="deeprob.spn.algorithms.html">deeprob.spn.algorithms package</a></li>
<li class="toctree-l5 current"><a class="current reference internal" href="#">deeprob.spn.layers package</a><ul>
<li class="toctree-l6"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l6"><a class="reference internal" href="#module-deeprob.spn.layers.dgcspn">deeprob.spn.layers.dgcspn module</a></li>
<li class="toctree-l6"><a class="reference internal" href="#module-deeprob.spn.layers.ratspn">deeprob.spn.layers.ratspn module</a></li>
<li class="toctree-l6"><a class="reference internal" href="#module-deeprob.spn.layers">Module contents</a></li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="deeprob.spn.learning.html">deeprob.spn.learning package</a></li>
<li class="toctree-l5"><a class="reference internal" href="deeprob.spn.models.html">deeprob.spn.models package</a></li>
<li class="toctree-l5"><a class="reference internal" href="deeprob.spn.structure.html">deeprob.spn.structure package</a></li>
<li class="toctree-l5"><a class="reference internal" href="deeprob.spn.utils.html">deeprob.spn.utils package</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="deeprob.spn.html#module-deeprob.spn">Module contents</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="deeprob.torch.html">deeprob.torch package</a></li>
<li class="toctree-l3"><a class="reference internal" href="deeprob.utils.html">deeprob.utils package</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="deeprob.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="deeprob.html#module-deeprob.context">deeprob.context module</a></li>
<li class="toctree-l2"><a class="reference internal" href="deeprob.html#module-deeprob">Module contents</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">DeeProb-kit</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="deeprob.html">deeprob package</a> &raquo;</li>
          <li><a href="deeprob.spn.html">deeprob.spn package</a> &raquo;</li>
      <li>deeprob.spn.layers package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/api/deeprob.spn.layers.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="deeprob-spn-layers-package">
<h1>deeprob.spn.layers package<a class="headerlink" href="#deeprob-spn-layers-package" title="Permalink to this headline"></a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline"></a></h2>
</section>
<section id="module-deeprob.spn.layers.dgcspn">
<span id="deeprob-spn-layers-dgcspn-module"></span><h2>deeprob.spn.layers.dgcspn module<a class="headerlink" href="#module-deeprob.spn.layers.dgcspn" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="deeprob.spn.layers.dgcspn.SpatialGaussianLayer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deeprob.spn.layers.dgcspn.</span></span><span class="sig-name descname"><span class="pre">SpatialGaussianLayer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimize_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quantiles_loc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uniform_loc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/deeprob/spn/layers/dgcspn.html#SpatialGaussianLayer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deeprob.spn.layers.dgcspn.SpatialGaussianLayer" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.module.Module</span></code></p>
<p>Initialize a Spatial Gaussian input layer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_features</strong> (<em>Tuple</em><em>[</em><em>int</em><em>, </em><em>int</em><em>, </em><em>int</em><em>]</em>) – The number of input features.</p></li>
<li><p><strong>out_channels</strong> (<em>int</em>) – The number of output channels.</p></li>
<li><p><strong>optimize_scale</strong> (<em>bool</em>) – Whether to optimize scale.</p></li>
<li><p><strong>dropout</strong> (<em>Optional</em><em>[</em><em>float</em><em>]</em>) – The leaf nodes dropout rate. It can be None.</p></li>
<li><p><strong>quantiles_loc</strong> (<em>Optional</em><em>[</em><em>numpy.ndarray</em><em>]</em>) – The mean quantiles for location initialization. It can be None.</p></li>
<li><p><strong>uniform_loc</strong> (<em>Optional</em><em>[</em><em>Tuple</em><em>[</em><em>float</em><em>, </em><em>float</em><em>]</em><em>]</em>) – The uniform range for location initialization. It can be None.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – If both quantiles_loc and uniform_loc are specified.</p>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="deeprob.spn.layers.dgcspn.SpatialGaussianLayer.in_channels">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">in_channels</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#deeprob.spn.layers.dgcspn.SpatialGaussianLayer.in_channels" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="deeprob.spn.layers.dgcspn.SpatialGaussianLayer.in_height">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">in_height</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#deeprob.spn.layers.dgcspn.SpatialGaussianLayer.in_height" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="deeprob.spn.layers.dgcspn.SpatialGaussianLayer.in_width">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">in_width</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#deeprob.spn.layers.dgcspn.SpatialGaussianLayer.in_width" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="deeprob.spn.layers.dgcspn.SpatialGaussianLayer.out_channels">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">out_channels</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#deeprob.spn.layers.dgcspn.SpatialGaussianLayer.out_channels" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="deeprob.spn.layers.dgcspn.SpatialGaussianLayer.out_height">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">out_height</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#deeprob.spn.layers.dgcspn.SpatialGaussianLayer.out_height" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="deeprob.spn.layers.dgcspn.SpatialGaussianLayer.out_width">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">out_width</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#deeprob.spn.layers.dgcspn.SpatialGaussianLayer.out_width" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deeprob.spn.layers.dgcspn.SpatialGaussianLayer.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/deeprob/spn/layers/dgcspn.html#SpatialGaussianLayer.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deeprob.spn.layers.dgcspn.SpatialGaussianLayer.forward" title="Permalink to this definition"></a></dt>
<dd><p>Evaluate the layer given some inputs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>x</strong> (<em>torch.Tensor</em>) – The inputs.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The outputs.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="deeprob.spn.layers.dgcspn.SpatialGaussianLayer.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#deeprob.spn.layers.dgcspn.SpatialGaussianLayer.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="deeprob.spn.layers.dgcspn.SpatialProductLayer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deeprob.spn.layers.dgcspn.</span></span><span class="sig-name descname"><span class="pre">SpatialProductLayer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dilation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depthwise</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/deeprob/spn/layers/dgcspn.html#SpatialProductLayer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deeprob.spn.layers.dgcspn.SpatialProductLayer" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.module.Module</span></code></p>
<p>Initialize a Spatial Product layer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_features</strong> (<em>Tuple</em><em>[</em><em>int</em><em>, </em><em>int</em><em>, </em><em>int</em><em>]</em>) – The number of input features.</p></li>
<li><p><strong>kernel_size</strong> (<em>Union</em><em>[</em><em>int</em><em>, </em><em>Tuple</em><em>[</em><em>int</em><em>, </em><em>int</em><em>]</em><em>]</em>) – The size of the kernels.</p></li>
<li><p><strong>stride</strong> (<em>Union</em><em>[</em><em>int</em><em>, </em><em>Tuple</em><em>[</em><em>int</em><em>, </em><em>int</em><em>]</em><em>]</em>) – The strides to use.</p></li>
<li><p><strong>padding</strong> (<em>str</em>) – The padding mode to use. It can be ‘valid’, ‘full’ or ‘final’.
Valid padding means no padding used. Full padding means padding is used based on effective
kernel size. Final padding means one-side padding (</p></li>
<li><p><strong>dilation</strong> (<em>Union</em><em>[</em><em>int</em><em>, </em><em>Tuple</em><em>[</em><em>int</em><em>, </em><em>int</em><em>]</em><em>]</em>) – The space between the kernel points.</p></li>
<li><p><strong>depthwise</strong> (<em>bool</em>) – Whether to use depthwise convolutions. If False, random sparse kernels are used.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – If a parameter is out of domain.</p>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="deeprob.spn.layers.dgcspn.SpatialProductLayer.in_channels">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">in_channels</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#deeprob.spn.layers.dgcspn.SpatialProductLayer.in_channels" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="deeprob.spn.layers.dgcspn.SpatialProductLayer.in_height">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">in_height</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#deeprob.spn.layers.dgcspn.SpatialProductLayer.in_height" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="deeprob.spn.layers.dgcspn.SpatialProductLayer.in_width">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">in_width</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#deeprob.spn.layers.dgcspn.SpatialProductLayer.in_width" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="deeprob.spn.layers.dgcspn.SpatialProductLayer.out_channels">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">out_channels</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#deeprob.spn.layers.dgcspn.SpatialProductLayer.out_channels" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="deeprob.spn.layers.dgcspn.SpatialProductLayer.out_height">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">out_height</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#deeprob.spn.layers.dgcspn.SpatialProductLayer.out_height" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="deeprob.spn.layers.dgcspn.SpatialProductLayer.out_width">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">out_width</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#deeprob.spn.layers.dgcspn.SpatialProductLayer.out_width" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deeprob.spn.layers.dgcspn.SpatialProductLayer.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/deeprob/spn/layers/dgcspn.html#SpatialProductLayer.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deeprob.spn.layers.dgcspn.SpatialProductLayer.forward" title="Permalink to this definition"></a></dt>
<dd><p>Evaluate the layer given some inputs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>x</strong> (<em>torch.Tensor</em>) – The inputs.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The outputs.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="deeprob.spn.layers.dgcspn.SpatialProductLayer.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#deeprob.spn.layers.dgcspn.SpatialProductLayer.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="deeprob.spn.layers.dgcspn.SpatialSumLayer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deeprob.spn.layers.dgcspn.</span></span><span class="sig-name descname"><span class="pre">SpatialSumLayer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/deeprob/spn/layers/dgcspn.html#SpatialSumLayer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deeprob.spn.layers.dgcspn.SpatialSumLayer" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.module.Module</span></code></p>
<p>Initialize a Spatial Sum layer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_features</strong> (<em>Tuple</em><em>[</em><em>int</em><em>, </em><em>int</em><em>, </em><em>int</em><em>]</em>) – The number of input features.</p></li>
<li><p><strong>out_channels</strong> (<em>int</em>) – The number of output channels.</p></li>
<li><p><strong>dropout</strong> (<em>Optional</em><em>[</em><em>float</em><em>]</em>) – The input nodes dropout rate. It can be None.</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="deeprob.spn.layers.dgcspn.SpatialSumLayer.in_channels">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">in_channels</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#deeprob.spn.layers.dgcspn.SpatialSumLayer.in_channels" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="deeprob.spn.layers.dgcspn.SpatialSumLayer.in_height">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">in_height</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#deeprob.spn.layers.dgcspn.SpatialSumLayer.in_height" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="deeprob.spn.layers.dgcspn.SpatialSumLayer.in_width">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">in_width</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#deeprob.spn.layers.dgcspn.SpatialSumLayer.in_width" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="deeprob.spn.layers.dgcspn.SpatialSumLayer.out_channels">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">out_channels</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#deeprob.spn.layers.dgcspn.SpatialSumLayer.out_channels" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="deeprob.spn.layers.dgcspn.SpatialSumLayer.out_height">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">out_height</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#deeprob.spn.layers.dgcspn.SpatialSumLayer.out_height" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="deeprob.spn.layers.dgcspn.SpatialSumLayer.out_width">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">out_width</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#deeprob.spn.layers.dgcspn.SpatialSumLayer.out_width" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deeprob.spn.layers.dgcspn.SpatialSumLayer.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/deeprob/spn/layers/dgcspn.html#SpatialSumLayer.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deeprob.spn.layers.dgcspn.SpatialSumLayer.forward" title="Permalink to this definition"></a></dt>
<dd><p>Evaluate the layer given some inputs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>x</strong> (<em>torch.Tensor</em>) – The inputs.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The outputs.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="deeprob.spn.layers.dgcspn.SpatialSumLayer.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#deeprob.spn.layers.dgcspn.SpatialSumLayer.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="deeprob.spn.layers.dgcspn.SpatialRootLayer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deeprob.spn.layers.dgcspn.</span></span><span class="sig-name descname"><span class="pre">SpatialRootLayer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/deeprob/spn/layers/dgcspn.html#SpatialRootLayer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deeprob.spn.layers.dgcspn.SpatialRootLayer" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.module.Module</span></code></p>
<p>Initialize a Spatial Root layer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_features</strong> (<em>Tuple</em><em>[</em><em>int</em><em>, </em><em>int</em><em>, </em><em>int</em><em>]</em>) – The number of input features.</p></li>
<li><p><strong>out_channels</strong> (<em>int</em>) – The number of output channels.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="deeprob.spn.layers.dgcspn.SpatialRootLayer.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#deeprob.spn.layers.dgcspn.SpatialRootLayer.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="deeprob.spn.layers.dgcspn.SpatialRootLayer.in_channels">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">in_channels</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#deeprob.spn.layers.dgcspn.SpatialRootLayer.in_channels" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="deeprob.spn.layers.dgcspn.SpatialRootLayer.in_height">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">in_height</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#deeprob.spn.layers.dgcspn.SpatialRootLayer.in_height" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="deeprob.spn.layers.dgcspn.SpatialRootLayer.in_width">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">in_width</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#deeprob.spn.layers.dgcspn.SpatialRootLayer.in_width" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deeprob.spn.layers.dgcspn.SpatialRootLayer.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/deeprob/spn/layers/dgcspn.html#SpatialRootLayer.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deeprob.spn.layers.dgcspn.SpatialRootLayer.forward" title="Permalink to this definition"></a></dt>
<dd><p>Evaluate the layer given some inputs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>x</strong> (<em>torch.Tensor</em>) – The inputs.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The outputs.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-deeprob.spn.layers.ratspn">
<span id="deeprob-spn-layers-ratspn-module"></span><h2>deeprob.spn.layers.ratspn module<a class="headerlink" href="#module-deeprob.spn.layers.ratspn" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="deeprob.spn.layers.ratspn.RegionGraphLayer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deeprob.spn.layers.ratspn.</span></span><span class="sig-name descname"><span class="pre">RegionGraphLayer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rg_depth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/deeprob/spn/layers/ratspn.html#RegionGraphLayer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deeprob.spn.layers.ratspn.RegionGraphLayer" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">abc.ABC</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.module.Module</span></code></p>
<p>Initialize a Region Graph-based base distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_features</strong> (<em>int</em>) – The number of input features.</p></li>
<li><p><strong>out_channels</strong> (<em>int</em>) – The number of channels for each base distribution layer.</p></li>
<li><p><strong>regions</strong> (<em>List</em><em>[</em><em>tuple</em><em>]</em>) – The regions of the distributions.</p></li>
<li><p><strong>rg_depth</strong> (<em>int</em>) – The depth of the region graph.</p></li>
<li><p><strong>dropout</strong> (<em>Optional</em><em>[</em><em>float</em><em>]</em>) – The leaf nodes dropout rate. It can be None.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="deeprob.spn.layers.ratspn.RegionGraphLayer.unpad_samples">
<span class="sig-name descname"><span class="pre">unpad_samples</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idx_group</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/deeprob/spn/layers/ratspn.html#RegionGraphLayer.unpad_samples"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deeprob.spn.layers.ratspn.RegionGraphLayer.unpad_samples" title="Permalink to this definition"></a></dt>
<dd><p>Reorder and unpad some samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>torch.Tensor</em>) – The samples.</p></li>
<li><p><strong>idx_group</strong> (<em>torch.Tensor</em>) – The group indices.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The reordered samples with padding dummy variables removed.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deeprob.spn.layers.ratspn.RegionGraphLayer.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/deeprob/spn/layers/ratspn.html#RegionGraphLayer.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deeprob.spn.layers.ratspn.RegionGraphLayer.forward" title="Permalink to this definition"></a></dt>
<dd><p>Execute the layer on some inputs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>x</strong> (<em>torch.Tensor</em>) – The inputs.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The log-likelihoods of each distribution leaf.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deeprob.spn.layers.ratspn.RegionGraphLayer.distribution_mode">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">distribution_mode</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/deeprob/spn/layers/ratspn.html#RegionGraphLayer.distribution_mode"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deeprob.spn.layers.ratspn.RegionGraphLayer.distribution_mode" title="Permalink to this definition"></a></dt>
<dd><p>Get the mode of the distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The mode of the distribution.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deeprob.spn.layers.ratspn.RegionGraphLayer.mpe">
<span class="sig-name descname"><span class="pre">mpe</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idx_group</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idx_offset</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/deeprob/spn/layers/ratspn.html#RegionGraphLayer.mpe"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deeprob.spn.layers.ratspn.RegionGraphLayer.mpe" title="Permalink to this definition"></a></dt>
<dd><p>Evaluate the layer given some inputs for maximum at posteriori estimation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>torch.Tensor</em>) – The inputs. Random variables can be marginalized using NaN values.</p></li>
<li><p><strong>idx_group</strong> (<em>torch.Tensor</em>) – The group indices.</p></li>
<li><p><strong>idx_offset</strong> (<em>torch.Tensor</em>) – The offset indices.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The samples having maximum at posteriori estimates on marginalized random variables.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deeprob.spn.layers.ratspn.RegionGraphLayer.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idx_group</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idx_offset</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/deeprob/spn/layers/ratspn.html#RegionGraphLayer.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deeprob.spn.layers.ratspn.RegionGraphLayer.sample" title="Permalink to this definition"></a></dt>
<dd><p>Sample from a base distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>idx_group</strong> (<em>torch.Tensor</em>) – The group indices.</p></li>
<li><p><strong>idx_offset</strong> (<em>torch.Tensor</em>) – The offset indices.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The computed samples.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="deeprob.spn.layers.ratspn.RegionGraphLayer.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#deeprob.spn.layers.ratspn.RegionGraphLayer.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="deeprob.spn.layers.ratspn.GaussianLayer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deeprob.spn.layers.ratspn.</span></span><span class="sig-name descname"><span class="pre">GaussianLayer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rg_depth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uniform_loc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimize_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/deeprob/spn/layers/ratspn.html#GaussianLayer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deeprob.spn.layers.ratspn.GaussianLayer" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#deeprob.spn.layers.ratspn.RegionGraphLayer" title="deeprob.spn.layers.ratspn.RegionGraphLayer"><code class="xref py py-class docutils literal notranslate"><span class="pre">deeprob.spn.layers.ratspn.RegionGraphLayer</span></code></a></p>
<p>Initialize a Gaussian distributions input layer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_features</strong> (<em>int</em>) – The number of input features.</p></li>
<li><p><strong>out_channels</strong> (<em>int</em>) – The number of channels for each base distribution layer.</p></li>
<li><p><strong>regions</strong> (<em>List</em><em>[</em><em>tuple</em><em>]</em>) – The regions of the distributions.</p></li>
<li><p><strong>rg_depth</strong> (<em>int</em>) – The depth of the region graph.</p></li>
<li><p><strong>dropout</strong> (<em>Optional</em><em>[</em><em>float</em><em>]</em>) – The leaf nodes dropout rate. It can be None.</p></li>
<li><p><strong>uniform_loc</strong> (<em>Optional</em><em>[</em><em>Tuple</em><em>[</em><em>float</em><em>, </em><em>float</em><em>]</em><em>]</em>) – The optional uniform distribution parameters for location initialization.</p></li>
<li><p><strong>optimize_scale</strong> (<em>bool</em>) – Whether to optimize scale and location jointly.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="deeprob.spn.layers.ratspn.GaussianLayer.distribution_mode">
<span class="sig-name descname"><span class="pre">distribution_mode</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/deeprob/spn/layers/ratspn.html#GaussianLayer.distribution_mode"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deeprob.spn.layers.ratspn.GaussianLayer.distribution_mode" title="Permalink to this definition"></a></dt>
<dd><p>Get the mode of the distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The mode of the distribution.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="deeprob.spn.layers.ratspn.GaussianLayer.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#deeprob.spn.layers.ratspn.GaussianLayer.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="deeprob.spn.layers.ratspn.BernoulliLayer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deeprob.spn.layers.ratspn.</span></span><span class="sig-name descname"><span class="pre">BernoulliLayer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rg_depth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/deeprob/spn/layers/ratspn.html#BernoulliLayer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deeprob.spn.layers.ratspn.BernoulliLayer" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#deeprob.spn.layers.ratspn.RegionGraphLayer" title="deeprob.spn.layers.ratspn.RegionGraphLayer"><code class="xref py py-class docutils literal notranslate"><span class="pre">deeprob.spn.layers.ratspn.RegionGraphLayer</span></code></a></p>
<p>Initialize a Bernoulli distributions input layer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_features</strong> (<em>int</em>) – The number of input features.</p></li>
<li><p><strong>out_channels</strong> (<em>int</em>) – The number of channels for each base distribution layer.</p></li>
<li><p><strong>regions</strong> (<em>List</em><em>[</em><em>tuple</em><em>]</em>) – The regions of the distributions.</p></li>
<li><p><strong>rg_depth</strong> (<em>int</em>) – The depth of the region graph.</p></li>
<li><p><strong>dropout</strong> (<em>Optional</em><em>[</em><em>float</em><em>]</em>) – The leaf nodes dropout rate. It can be None.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="deeprob.spn.layers.ratspn.BernoulliLayer.distribution_mode">
<span class="sig-name descname"><span class="pre">distribution_mode</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/deeprob/spn/layers/ratspn.html#BernoulliLayer.distribution_mode"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deeprob.spn.layers.ratspn.BernoulliLayer.distribution_mode" title="Permalink to this definition"></a></dt>
<dd><p>Get the mode of the distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The mode of the distribution.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="deeprob.spn.layers.ratspn.BernoulliLayer.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#deeprob.spn.layers.ratspn.BernoulliLayer.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="deeprob.spn.layers.ratspn.ProductLayer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deeprob.spn.layers.ratspn.</span></span><span class="sig-name descname"><span class="pre">ProductLayer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_regions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_nodes</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/deeprob/spn/layers/ratspn.html#ProductLayer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deeprob.spn.layers.ratspn.ProductLayer" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.module.Module</span></code></p>
<p>Initialize the Product layer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_regions</strong> (<em>int</em>) – The number of input regions.</p></li>
<li><p><strong>in_nodes</strong> (<em>int</em>) – The number of input nodes per region.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="deeprob.spn.layers.ratspn.ProductLayer.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/deeprob/spn/layers/ratspn.html#ProductLayer.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deeprob.spn.layers.ratspn.ProductLayer.forward" title="Permalink to this definition"></a></dt>
<dd><p>Evaluate the layer given some inputs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>x</strong> (<em>torch.Tensor</em>) – The inputs.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The outputs.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deeprob.spn.layers.ratspn.ProductLayer.mpe">
<span class="sig-name descname"><span class="pre">mpe</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idx_group</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idx_offset</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/deeprob/spn/layers/ratspn.html#ProductLayer.mpe"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deeprob.spn.layers.ratspn.ProductLayer.mpe" title="Permalink to this definition"></a></dt>
<dd><p>Evaluate the layer given some inputs for maximum at posteriori estimation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>torch.Tensor</em>) – The inputs (not used here).</p></li>
<li><p><strong>idx_group</strong> (<em>torch.Tensor</em>) – The group indices.</p></li>
<li><p><strong>idx_offset</strong> (<em>torch.Tensor</em>) – The offset indices.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The group and offset indices.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deeprob.spn.layers.ratspn.ProductLayer.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idx_group</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idx_offset</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/deeprob/spn/layers/ratspn.html#ProductLayer.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deeprob.spn.layers.ratspn.ProductLayer.sample" title="Permalink to this definition"></a></dt>
<dd><p>Sample from a product layer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>idx_group</strong> (<em>torch.Tensor</em>) – The group indices.</p></li>
<li><p><strong>idx_offset</strong> (<em>torch.Tensor</em>) – The offset indices.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The group and offset indices.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Tuple[torch.Tensor, torch.Tensor]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="deeprob.spn.layers.ratspn.ProductLayer.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#deeprob.spn.layers.ratspn.ProductLayer.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="deeprob.spn.layers.ratspn.SumLayer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deeprob.spn.layers.ratspn.</span></span><span class="sig-name descname"><span class="pre">SumLayer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_partitions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_nodes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_nodes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/deeprob/spn/layers/ratspn.html#SumLayer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deeprob.spn.layers.ratspn.SumLayer" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.module.Module</span></code></p>
<p>Initialize the sum layer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_partitions</strong> (<em>int</em>) – The number of input partitions.</p></li>
<li><p><strong>in_nodes</strong> (<em>int</em>) – The number of input nodes per partition.</p></li>
<li><p><strong>out_nodes</strong> (<em>int</em>) – The number of output nodes per region.</p></li>
<li><p><strong>dropout</strong> (<em>Optional</em><em>[</em><em>float</em><em>]</em>) – The input nodes dropout rate. It can be None.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="deeprob.spn.layers.ratspn.SumLayer.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/deeprob/spn/layers/ratspn.html#SumLayer.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deeprob.spn.layers.ratspn.SumLayer.forward" title="Permalink to this definition"></a></dt>
<dd><p>Evaluate the layer given some inputs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>x</strong> (<em>torch.Tensor</em>) – The inputs.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The outputs.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deeprob.spn.layers.ratspn.SumLayer.mpe">
<span class="sig-name descname"><span class="pre">mpe</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idx_group</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idx_offset</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/deeprob/spn/layers/ratspn.html#SumLayer.mpe"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deeprob.spn.layers.ratspn.SumLayer.mpe" title="Permalink to this definition"></a></dt>
<dd><p>Evaluate the layer given some inputs for maximum at posteriori estimation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>torch.Tensor</em>) – The inputs.</p></li>
<li><p><strong>idx_group</strong> (<em>torch.Tensor</em>) – The group indices.</p></li>
<li><p><strong>idx_offset</strong> (<em>torch.Tensor</em>) – The offset indices.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The group and offset indices.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deeprob.spn.layers.ratspn.SumLayer.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idx_group</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idx_offset</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/deeprob/spn/layers/ratspn.html#SumLayer.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deeprob.spn.layers.ratspn.SumLayer.sample" title="Permalink to this definition"></a></dt>
<dd><p>Sample from a sum layer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>idx_group</strong> (<em>torch.Tensor</em>) – The group indices.</p></li>
<li><p><strong>idx_offset</strong> (<em>torch.Tensor</em>) – The offset indices.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The group and offset indices.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Tuple[torch.Tensor, torch.Tensor]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="deeprob.spn.layers.ratspn.SumLayer.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#deeprob.spn.layers.ratspn.SumLayer.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="deeprob.spn.layers.ratspn.RootLayer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deeprob.spn.layers.ratspn.</span></span><span class="sig-name descname"><span class="pre">RootLayer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_partitions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_nodes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_classes</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/deeprob/spn/layers/ratspn.html#RootLayer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deeprob.spn.layers.ratspn.RootLayer" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.module.Module</span></code></p>
<p>Initialize the root layer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_partitions</strong> (<em>int</em>) – The number of input partitions.</p></li>
<li><p><strong>in_nodes</strong> (<em>int</em>) – The number of input nodes per partition.</p></li>
<li><p><strong>out_classes</strong> (<em>int</em>) – The number of output nodes.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="deeprob.spn.layers.ratspn.RootLayer.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/deeprob/spn/layers/ratspn.html#RootLayer.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deeprob.spn.layers.ratspn.RootLayer.forward" title="Permalink to this definition"></a></dt>
<dd><p>Evaluate the layer given some inputs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>x</strong> – The inputs.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The outputs.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deeprob.spn.layers.ratspn.RootLayer.mpe">
<span class="sig-name descname"><span class="pre">mpe</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/deeprob/spn/layers/ratspn.html#RootLayer.mpe"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deeprob.spn.layers.ratspn.RootLayer.mpe" title="Permalink to this definition"></a></dt>
<dd><p>Evaluate the layer given some inputs for maximum at posteriori estimation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>torch.Tensor</em>) – The inputs.</p></li>
<li><p><strong>y</strong> (<em>torch.Tensor</em>) – The target classes.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The group and offset indices.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Tuple[torch.Tensor, torch.Tensor]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="deeprob.spn.layers.ratspn.RootLayer.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#deeprob.spn.layers.ratspn.RootLayer.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deeprob.spn.layers.ratspn.RootLayer.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/deeprob/spn/layers/ratspn.html#RootLayer.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deeprob.spn.layers.ratspn.RootLayer.sample" title="Permalink to this definition"></a></dt>
<dd><p>Sample from the root layer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>y</strong> (<em>torch.Tensor</em>) – The target classes.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The group and offset indices.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Tuple[torch.Tensor, torch.Tensor]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-deeprob.spn.layers">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-deeprob.spn.layers" title="Permalink to this headline"></a></h2>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="deeprob.spn.algorithms.html" class="btn btn-neutral float-left" title="deeprob.spn.algorithms package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="deeprob.spn.learning.html" class="btn btn-neutral float-right" title="deeprob.spn.learning package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Lorenzo Loconte, Gennaro Gala.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    <span class="fa fa-book"> Other Versions</span>
    v: v1.0.0
    <span class="fa fa-caret-down"></span>
  </span>
  <div class="rst-other-versions">
    <dl>
      <dt>Tags</dt>
      <dd><a href="deeprob.spn.layers.html">v1.0.0</a></dd>
      <dd><a href="../../v1.1.0/index.html">v1.1.0</a></dd>
    </dl>
    <dl>
      <dt>Branches</dt>
      <dd><a href="../../main/index.html">main</a></dd>
    </dl>
  </div>
</div><script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>